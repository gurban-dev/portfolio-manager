{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///app/src/lib/auth/authService.ts"],"sourcesContent":["import axios from 'axios';\nimport { jwtDecode } from 'jwt-decode';\n\nconst API_URL = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:8000';\n\ninterface AuthTokens {\n  access: string;\n  refresh: string;\n}\n\ninterface User {\n  id: number;\n  email: string;\n  username: string;\n  first_name: string;\n  last_name: string;\n}\n\nexport const authService = {\n  // Store tokens in localStorage\n  setTokens(tokens: AuthTokens) {\n    localStorage.setItem('access_token', tokens.access);\n    localStorage.setItem('refresh_token', tokens.refresh);\n  },\n\n  getAccessToken(): string | null {\n    return localStorage.getItem('access_token');\n  },\n\n  getRefreshToken(): string | null {\n    return localStorage.getItem('refresh_token');\n  },\n\n  clearTokens() {\n    localStorage.removeItem('access_token');\n    localStorage.removeItem('refresh_token');\n  },\n\n  isAuthenticated(): boolean {\n    const token = this.getAccessToken();\n    if (!token) return false;\n\n    try {\n      const decoded: any = jwtDecode(token);\n      return decoded.exp * 1000 > Date.now();\n    } catch {\n      return false;\n    }\n  },\n\n  // Google OAuth login\n  async loginWithGoogle(googleAccessToken: string) {\n    try {\n      console.log('In lib/auth/authService.ts loginWithGoogle() googleAccessToken:', googleAccessToken);\n\n      const response = await axios.post(`${API_URL}/api/auth/google/`, {\n        access_token: googleAccessToken,\n      });\n\n      const { access, refresh, user } = response.data;\n      \n      this.setTokens({ access, refresh });\n      \n      return { user, created: response.data.created };\n    } catch (error: any) {\n      throw new Error(error.response?.data?.error || 'Google login failed');\n    }\n  },\n\n  // Google OAuth login (redirect-based auth-code flow)\n  async loginWithGoogleAuthCode(authCode: string) {\n    try {\n      const response = await axios.post(`${API_URL}/api/auth/google/callback/`, {\n        code: authCode,\n      });\n\n      const { access, refresh, user } = response.data;\n\n      this.setTokens({ access, refresh });\n      \n      return { user, created: response.data.created };\n    } catch (error: any) {\n      throw new Error(error.response?.data?.error || 'Google login failed');\n    }\n  },\n\n  // Traditional email/password login\n  async login(email: string, password: string) {\n    try {\n      const response = await axios.post(`${API_URL}/api/auth/login/`, {\n        email,\n        password,\n      });\n\n      const { access_token, refresh_token, user } = response.data;\n      \n      this.setTokens({ access: access_token, refresh: refresh_token });\n      \n      return { user };\n    } catch (error: any) {\n      throw new Error(error.response?.data?.error || 'Login failed');\n    }\n  },\n\n  // Register new user\n  async register(email: string, password1: string, password2: string) {\n    try {\n      const response = await axios.post(`${API_URL}/api/auth/registration/`, {\n        email,\n        password1,\n        password2,\n      });\n\n      const { access_token, refresh_token, user } = response.data;\n      \n      this.setTokens({ access: access_token, refresh: refresh_token });\n      \n      return { user };\n    } catch (error: any) {\n      throw new Error(error.response?.data?.error || 'Registration failed');\n    }\n  },\n\n  // Logout\n  async logout() {\n    try {\n      const refreshToken = this.getRefreshToken();\n      if (refreshToken) {\n        await axios.post(`${API_URL}/api/auth/logout/`, {\n          refresh: refreshToken,\n        });\n      }\n    } catch (error) {\n      console.error('Logout error:', error);\n    } finally {\n      this.clearTokens();\n    }\n  },\n\n  // Get current user\n  async getCurrentUser(): Promise<User | null> {\n    try {\n      const token = this.getAccessToken();\n      if (!token) return null;\n\n      const response = await axios.get(`${API_URL}/api/auth/user/`, {\n        headers: {\n          Authorization: `Bearer ${token}`,\n        },\n      });\n\n      return response.data;\n    } catch (error) {\n      return null;\n    }\n  },\n};"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 160, "column": 0}, "map": {"version":3,"sources":["file:///app/src/app/auth/callback/page.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect, useState } from 'react';\nimport { useRouter, useSearchParams } from 'next/navigation';\nimport { authService } from '@/lib/auth/authService';\n\nexport default function AuthCallbackPage() {\n  const router = useRouter();\n\n  const searchParams = useSearchParams();\n\n  const [error, setError] = useState<string | null>(null);\n\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    if (typeof window !== \"undefined\") {\n      console.log(\"Callback URL in browser:\", window.location.href);\n    }\n\n    const handleCallback = async () => {\n      try {\n        // Null check.\n        if (!searchParams) {\n          throw new Error('Search parameters not available');\n        }else{\n          console.log('searchParams.toString():', searchParams.toString());\n        }\n\n        const code = searchParams.get('code');\n\n        if (!code) {\n          throw new Error('No authorization code received from Google');\n        }else{\n          console.log('‚úÖ Authorization code received:', code);\n        }\n\n        const state = searchParams.get('state');\n\n        // State is optional - just log if present.\n        if (state) {\n          console.log('üìã State parameter:', state);\n          // Optionally verify state matches what you sent\n        } else {\n          console.log('‚ÑπÔ∏è No state parameter (optional)');\n        }\n\n        // Send the code to your backend.\n        const { user, created } = await authService.loginWithGoogleAuthCode(code);\n\n        console.log('‚úÖ Login successful:', user);\n\n        // Redirect to dashboard\n        router.push('/dashboard');\n      } catch (err: any) {\n        console.error('‚ùå Authentication error:', err);\n\n        setError(err.message || 'Authentication failed');\n\n        setLoading(false);\n      }\n    };\n\n    if (searchParams) {\n      handleCallback();\n    }\n  }, [searchParams, router]);\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <div className=\"text-center\">\n          <div className=\"w-12 h-12 border-4 border-gray-300 border-t-blue-600 rounded-full animate-spin mx-auto mb-4\"></div>\n          <p className=\"text-gray-700\">Authenticating with Google...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <div className=\"text-center\">\n          <p className=\"text-red-600 mb-4\">{error}</p>\n          <button\n            onClick={() => router.push('/auth')}\n            className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 cursor-pointer\"\n          >\n            Back to Login\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  return null;\n}"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;;;AAJA;;;;AAMe,SAAS;;IACtB,MAAM,SAAS,IAAA,kJAAS;IAExB,MAAM,eAAe,IAAA,wJAAe;IAEpC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAgB;IAElD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IAEvC,IAAA,0KAAS;sCAAC;YACR,wCAAmC;gBACjC,QAAQ,GAAG,CAAC,4BAA4B,OAAO,QAAQ,CAAC,IAAI;YAC9D;YAEA,MAAM;6DAAiB;oBACrB,IAAI;wBACF,cAAc;wBACd,IAAI,CAAC,cAAc;4BACjB,MAAM,IAAI,MAAM;wBAClB,OAAK;4BACH,QAAQ,GAAG,CAAC,4BAA4B,aAAa,QAAQ;wBAC/D;wBAEA,MAAM,OAAO,aAAa,GAAG,CAAC;wBAE9B,IAAI,CAAC,MAAM;4BACT,MAAM,IAAI,MAAM;wBAClB,OAAK;4BACH,QAAQ,GAAG,CAAC,kCAAkC;wBAChD;wBAEA,MAAM,QAAQ,aAAa,GAAG,CAAC;wBAE/B,2CAA2C;wBAC3C,IAAI,OAAO;4BACT,QAAQ,GAAG,CAAC,uBAAuB;wBACnC,gDAAgD;wBAClD,OAAO;4BACL,QAAQ,GAAG,CAAC;wBACd;wBAEA,iCAAiC;wBACjC,MAAM,EAAE,IAAI,EAAE,OAAO,EAAE,GAAG,MAAM,mJAAW,CAAC,uBAAuB,CAAC;wBAEpE,QAAQ,GAAG,CAAC,uBAAuB;wBAEnC,wBAAwB;wBACxB,OAAO,IAAI,CAAC;oBACd,EAAE,OAAO,KAAU;wBACjB,QAAQ,KAAK,CAAC,2BAA2B;wBAEzC,SAAS,IAAI,OAAO,IAAI;wBAExB,WAAW;oBACb;gBACF;;YAEA,IAAI,cAAc;gBAChB;YACF;QACF;qCAAG;QAAC;QAAc;KAAO;IAEzB,IAAI,SAAS;QACX,qBACE,6LAAC;YAAI,WAAU;sBACb,cAAA,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAI,WAAU;;;;;;kCACf,6LAAC;wBAAE,WAAU;kCAAgB;;;;;;;;;;;;;;;;;IAIrC;IAEA,IAAI,OAAO;QACT,qBACE,6LAAC;YAAI,WAAU;sBACb,cAAA,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAE,WAAU;kCAAqB;;;;;;kCAClC,6LAAC;wBACC,SAAS,IAAM,OAAO,IAAI,CAAC;wBAC3B,WAAU;kCACX;;;;;;;;;;;;;;;;;IAMT;IAEA,OAAO;AACT;GA1FwB;;QACP,kJAAS;QAEH,wJAAe;;;KAHd","debugId":null}},
    {"offset": {"line": 313, "column": 0}, "map": {"version":3,"sources":["file:///app/node_modules/next/navigation.js"],"sourcesContent":["module.exports = require('./dist/client/components/navigation')\n"],"names":[],"mappings":"AAAA,OAAO,OAAO","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 318, "column": 0}, "map": {"version":3,"sources":["file:///app/node_modules/jwt-decode/build/esm/index.js"],"sourcesContent":["export class InvalidTokenError extends Error {\n}\nInvalidTokenError.prototype.name = \"InvalidTokenError\";\nfunction b64DecodeUnicode(str) {\n    return decodeURIComponent(atob(str).replace(/(.)/g, (m, p) => {\n        let code = p.charCodeAt(0).toString(16).toUpperCase();\n        if (code.length < 2) {\n            code = \"0\" + code;\n        }\n        return \"%\" + code;\n    }));\n}\nfunction base64UrlDecode(str) {\n    let output = str.replace(/-/g, \"+\").replace(/_/g, \"/\");\n    switch (output.length % 4) {\n        case 0:\n            break;\n        case 2:\n            output += \"==\";\n            break;\n        case 3:\n            output += \"=\";\n            break;\n        default:\n            throw new Error(\"base64 string is not of the correct length\");\n    }\n    try {\n        return b64DecodeUnicode(output);\n    }\n    catch (err) {\n        return atob(output);\n    }\n}\nexport function jwtDecode(token, options) {\n    if (typeof token !== \"string\") {\n        throw new InvalidTokenError(\"Invalid token specified: must be a string\");\n    }\n    options || (options = {});\n    const pos = options.header === true ? 0 : 1;\n    const part = token.split(\".\")[pos];\n    if (typeof part !== \"string\") {\n        throw new InvalidTokenError(`Invalid token specified: missing part #${pos + 1}`);\n    }\n    let decoded;\n    try {\n        decoded = base64UrlDecode(part);\n    }\n    catch (e) {\n        throw new InvalidTokenError(`Invalid token specified: invalid base64 for part #${pos + 1} (${e.message})`);\n    }\n    try {\n        return JSON.parse(decoded);\n    }\n    catch (e) {\n        throw new InvalidTokenError(`Invalid token specified: invalid json for part #${pos + 1} (${e.message})`);\n    }\n}\n"],"names":[],"mappings":";;;;;;AAAO,MAAM,0BAA0B;AACvC;AACA,kBAAkB,SAAS,CAAC,IAAI,GAAG;AACnC,SAAS,iBAAiB,GAAG;IACzB,OAAO,mBAAmB,KAAK,KAAK,OAAO,CAAC,QAAQ,CAAC,GAAG;QACpD,IAAI,OAAO,EAAE,UAAU,CAAC,GAAG,QAAQ,CAAC,IAAI,WAAW;QACnD,IAAI,KAAK,MAAM,GAAG,GAAG;YACjB,OAAO,MAAM;QACjB;QACA,OAAO,MAAM;IACjB;AACJ;AACA,SAAS,gBAAgB,GAAG;IACxB,IAAI,SAAS,IAAI,OAAO,CAAC,MAAM,KAAK,OAAO,CAAC,MAAM;IAClD,OAAQ,OAAO,MAAM,GAAG;QACpB,KAAK;YACD;QACJ,KAAK;YACD,UAAU;YACV;QACJ,KAAK;YACD,UAAU;YACV;QACJ;YACI,MAAM,IAAI,MAAM;IACxB;IACA,IAAI;QACA,OAAO,iBAAiB;IAC5B,EACA,OAAO,KAAK;QACR,OAAO,KAAK;IAChB;AACJ;AACO,SAAS,UAAU,KAAK,EAAE,OAAO;IACpC,IAAI,OAAO,UAAU,UAAU;QAC3B,MAAM,IAAI,kBAAkB;IAChC;IACA,WAAW,CAAC,UAAU,CAAC,CAAC;IACxB,MAAM,MAAM,QAAQ,MAAM,KAAK,OAAO,IAAI;IAC1C,MAAM,OAAO,MAAM,KAAK,CAAC,IAAI,CAAC,IAAI;IAClC,IAAI,OAAO,SAAS,UAAU;QAC1B,MAAM,IAAI,kBAAkB,AAAC,0CAAiD,OAAR,MAAM;IAChF;IACA,IAAI;IACJ,IAAI;QACA,UAAU,gBAAgB;IAC9B,EACA,OAAO,GAAG;QACN,MAAM,IAAI,kBAAkB,AAAC,qDAAgE,OAAZ,MAAM,GAAE,MAAc,OAAV,EAAE,OAAO,EAAC;IAC3G;IACA,IAAI;QACA,OAAO,KAAK,KAAK,CAAC;IACtB,EACA,OAAO,GAAG;QACN,MAAM,IAAI,kBAAkB,AAAC,mDAA8D,OAAZ,MAAM,GAAE,MAAc,OAAV,EAAE,OAAO,EAAC;IACzG;AACJ","ignoreList":[0],"debugId":null}}]
}